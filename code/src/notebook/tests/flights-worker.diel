CREATE EVENT TABLE originSelectionEvent (airportCode number);

create view currenOriginSelection AS
  select airportCode, timestep from originSelectionEvent order by timestep desc limit 1;

create output allPastSelections AS
  select distinct airportCode from originSelectionEvent order by timestep;

create output delayDistanceByOrigin AS
  select *
  from delayDistanceByOriginEvent e
  join currenOriginSelection s on e.timestep = s.timestep;
  
create event view delayDistanceByOriginEvent AS
  select f.delay, f.distance
  from flights f
  join currenOriginSelection s on f.origin = s.origin;

-- note: this is a bit annoying...
create output allOriginAirports AS
  select * from allOriginAirportsEvent;

create event view allOriginAirportsEvent AS
  select distinct origin
  from flights;